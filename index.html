<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>종합소득세 + 건보료 계산기</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 0;
    background: #f4f6f8;
  }
  .container {
    max-width: 480px;
    margin: 30px auto;
    padding: 20px;
    background: white;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    border-radius: 10px;
  }
  h2 {
    text-align: center;
    margin-bottom: 20px;
  }
  label {
    display: block;
    margin-top: 10px;
    font-weight: bold;
  }
  input,
  select {
    width: 100%;
    padding: 8px;
    margin-top: 5px;
    border: 1px solid #ccc;
    border-radius: 5px;
    box-sizing: border-box;
  }
  button {
    width: 100%;
    margin-top: 20px;
    padding: 12px;
    background: #4caf50;
    color: white;
    border: none;
    border-radius: 5px;
    font-size: 16px;
    cursor: pointer;
  }
  button:hover {
    background: #45a049;
  }
  table {
    width: 100%;
    margin-top: 20px;
    border-collapse: collapse;
  }
  th,
  td {
    border: 1px solid #ddd;
    padding: 10px;
    text-align: right;
  }
  th {
    background: #f0f0f0;
    text-align: left;
  }
</style>
</head>
<body>
  <div class="container">
    <h2>종합소득세 + 건보료 계산기</h2>

    <label for="workIncome">근로소득 (만원)</label>
    <input type="number" id="workIncome" value="3000" min="0" />

    <label for="dividendIncome">배당소득 (만원)</label>
    <input type="number" id="dividendIncome" value="2500" min="0" />

    <label for="propertyValue">재산 (만원)</label>
    <input type="number" id="propertyValue" value="20000" min="0" />

    <label for="isLocalMember">지역가입자 여부</label>
    <select id="isLocalMember">
      <option value="false">아니오</option>
      <option value="true">예</option>
    </select>

    <button onclick="calculate()">계산하기</button>

    <table id="resultTable" style="display:none">
      <tbody>
        <tr><th>과세표준</th><td id="taxableIncome"></td></tr>
        <tr><th>종합소득세</th><td id="incomeTax"></td></tr>
        <tr><th>지방소득세</th><td id="localTax"></td></tr>
        <tr><th>총 세금</th><td id="totalTax"></td></tr>
        <tr><th>연간 건강보험료</th><td id="annualNHIP"></td></tr>
        <tr><th>월 건강보험료</th><td id="monthlyNHIP"></td></tr>
      </tbody>
    </table>
  </div>

  <script>
    function calcTaxAndNHIP({ workIncome = 0, dividendIncome = 0, propertyValue = 0, isLocalMember = false }) {
      // 입력 단위 만원 → 원 변환
      workIncome *= 10000;
      dividendIncome *= 10000;
      propertyValue *= 10000;

      let workDeduction = 0;
      if (workIncome <= 5000000) workDeduction = workIncome * 0.7;
      else if (workIncome <= 15000000) workDeduction = 3500000 + (workIncome - 5000000) * 0.4;
      else if (workIncome <= 45000000) workDeduction = 7500000 + (workIncome - 15000000) * 0.15;
      else if (workIncome <= 100000000) workDeduction = 12000000 + (workIncome - 45000000) * 0.05;
      else workDeduction = 14750000 + (workIncome - 100000000) * 0.02;

      const taxableIncome = Math.max(0, (workIncome - workDeduction) + dividendIncome);

      const taxTable = [
        { limit: 14000000, rate: 0.06, minus: 0 },
        { limit: 50000000, rate: 0.15, minus: 1260000 },
        { limit: 88000000, rate: 0.24, minus: 5760000 },
        { limit: 150000000, rate: 0.35, minus: 15440000 },
        { limit: 300000000, rate: 0.38, minus: 19940000 },
        { limit: 500000000, rate: 0.40, minus: 25940000 },
        { limit: 1000000000, rate: 0.42, minus: 35940000 },
        { limit: Infinity, rate: 0.45, minus: 65940000 },
      ];

      const bracket = taxTable.find(b => taxableIncome <= b.limit);
      const incomeTax = taxableIncome * bracket.rate - bracket.minus;

      const localTax = incomeTax * 0.1;

      const nhipRate = 0.0709;
      const ltcRate = 0.09182;

      let annualNHIP = 0;
      if (!isLocalMember) {
        if (dividendIncome > 20000000) {
          annualNHIP = (dividendIncome - 20000000) * nhipRate;
        }
      } else {
        const propertyScore = propertyValue / 10000000 * 50;
        const propertyMonthly = propertyScore * 205;
        const propertyAnnual = propertyMonthly * 12;
        annualNHIP = taxableIncome * nhipRate + propertyAnnual;
      }

      const annualLTC = annualNHIP * ltcRate;
      const totalAnnualNHIP = annualNHIP + annualLTC;

      return {
        taxableIncome: taxableIncome.toLocaleString() + ' 원',
        incomeTax: Math.round(incomeTax).toLocaleString() + ' 원',
        localTax: Math.round(localTax).toLocaleString() + ' 원',
        totalTax: Math.round(incomeTax + localTax).toLocaleString() + ' 원',
        annualNHIP: Math.round(totalAnnualNHIP).toLocaleString() + ' 원',
        monthlyNHIP: Math.round(totalAnnualNHIP / 12).toLocaleString() + ' 원',
      };
    }

    function calculate() {
      const workIncome = parseInt(document.getElementById('workIncome').value, 10);
      const dividendIncome = parseInt(document.getElementById('dividendIncome').value, 10);
      const propertyValue = parseInt(document.getElementById('propertyValue').value, 10);
      const isLocalMember = document.getElementById('isLocalMember').value === 'true';

      const result = calcTaxAndNHIP({ workIncome, dividendIncome, propertyValue, isLocalMember });

      document.getElementById('resultTable').style.display = 'table';
      document.getElementById('taxableIncome').textContent = result.taxableIncome;
      document.getElementById('incomeTax').textContent = result.incomeTax;
      document.getElementById('localTax').textContent = result.localTax;
      document.getElementById('totalTax').textContent = result.totalTax;
      document.getElementById('annualNHIP').textContent = result.annualNHIP;
      document.getElementById('monthlyNHIP').textContent = result.monthlyNHIP;
    }
  </script>
</body>
</html>
